<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Quiz</title>
    <style>
        /* Dein CSS-Styling */
        body {
            font-family: 'Roboto', sans-serif;
            text-align: center;
        }
        .question {
            margin: 20px;
        }
        .answer-option {
            margin: 10px 0;
        }
        .drag-drop-area {
            border: 2px dashed #ccc;
            padding: 10px;
            margin: 10px auto;
            width: calc(50% - 20px);
            display: block;
        }
        .key-item, .draggable-item {
            border: 1px solid #ddd;
            padding: 8px;
            margin-bottom: 4px;
            background-color: #f8f8f8;
            transition: all 0.3s ease;
        }
        .key-item {
            background-color: #e0e0e0; /* Dunklerer Hintergrund für Schlüssel */
            cursor: default;
        }
        .draggable-item {
            cursor: move;
            background-color: #ffffff; /* Hintergrund für verschiebbare Elemente */
        }
        .value-dropzone {
            border: 2px dashed #ccc;
            padding: 10px;
            margin: 10px auto;
            width: calc(50% - 20px);
            min-height: 150px;
            display: block;
        }
        /* Flex-Container für die Paar-Ansicht */
        .pairs-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        /* Weitere Styles hier hinzufügen */
    </style>
</head>
<body>
    <!-- Debug-Ausgabe der aktuellen Frage -->
    <div style="background-color: lightgrey; padding: 10px; margin-bottom: 20px;">
        <strong>Debug-Information (Aktuelle Frage):</strong>
        <pre>{{ question | tojson(indent=2) }}</pre>
    </div>

    <form action="/submit_answer" method="post">
        <div class="question">
            <h2>Frage {{ question_index + 1 }} von {{ total_questions }}</h2>
            <p>{{ question.question_text }}</p>

            <!-- Bereich für die Antwortoptionen, dynamisch anhand des Fragetyps -->
            <div class="answers">
                {% if question.type == 'drag_drop_pairs' %}
                    <div class="pairs-container">
                        <!-- Nicht-verschiebbare Schlüssel -->
                        <div>
                            <p>Schlüssel</p>
                            {% for key, value in question["items"].items() %}
                                <div class="key-item" id="key-{{ key }}">
                                    {{ key }}
                                </div>
                            {% endfor %}
                        </div>
                        <!-- Verschiebbare Werte Dropzone -->
                        <div class="value-dropzone" id="value-dropzone">
                            <p>Werte Dropzone</p>
                            {% for key, value in question["items"].items() %}
                                <div class="draggable-item" draggable="true" id="value-{{ key }}">
                                    {{ value }}
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                {% elif question.type == 'drag_drop_order' %}
                    <!-- Code für Drag-and-Drop-Order-Fragen -->
                    <div class="drag-drop-area">
                        {% for key, value in question["items"].items() %}
                            <div class="draggable-item" draggable="true" id="item-{{ key }}">
                                {{ value }}
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- Navigationsbuttons -->
        <div class="buttons">
            <button type="submit">Antworten senden</button>
        </div>
    </form>

    <div class="buttons">
        <button onclick="location.href='/change_question?direction=prev'">Vorherige Frage</button>
        <button onclick="location.href='/change_question?direction=next'">Nächste Frage</button>
        <button onclick="confirmExit()">Quiz Beenden</button>
    </div>

    <!-- JavaScript für zusätzliche Funktionen -->
    <script>
        function confirmExit() {
            if (confirm("Möchtest du das Quiz wirklich beenden?")) {
                location.href = "/end_quiz";
            }
        }
        
        function setupDragAndDrop(draggablesSelector, dropAreaSelector) {
            let draggables = document.querySelectorAll(draggablesSelector);
            let dropAreas = document.querySelectorAll(dropAreaSelector);
        
            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', e => {
                    e.dataTransfer.setData('text/plain', draggable.id);
                    draggable.classList.add('dragging');
                });
        
                draggable.addEventListener('dragend', () => {
                    draggable.classList.remove('dragging');
                });
            });
        
            dropAreas.forEach(dropArea => {
                dropArea.addEventListener('dragover', e => {
                    e.preventDefault();
                    const afterElement = getDragAfterElement(dropArea, e.clientY);
                    const dragging = document.querySelector('.dragging');
                    if (afterElement == null) {
                        dropArea.appendChild(dragging);
                    } else {
                        dropArea.insertBefore(dragging, afterElement);
                    }
                });
        
                dropArea.addEventListener('drop', e => {
                    e.preventDefault();
                    const id = e.dataTransfer.getData('text/plain');
                    const draggable = document.getElementById(id);
                    dropArea.appendChild(draggable);
                    draggable.classList.remove('dragging');
                });
            });
        }
    
        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.draggable-item:not(.dragging)')];
    
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }
        document.addEventListener('DOMContentLoaded', () => {
        // Setup für Drag-and-Drop-Pairs
        if (document.querySelector('.value-dropzone')) {
            setupDragAndDrop('.value-dropzone .draggable-item', '.value-dropzone');
        }
        
        // Setup für Drag-and-Drop-Order
        if (document.querySelector('.drag-drop-area')) {
            setupDragAndDrop('.drag-drop-area .draggable-item', '.drag-drop-area');
        }
        });
    </script>
</body>
</html>
    
    
    
</body>
</html>
